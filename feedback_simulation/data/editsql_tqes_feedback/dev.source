find for each value of director whose number of rows equals 1 . [question] What are the names of all directors who made one movie ? [system description] find the director in movie table . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the invoices table . [question] Show the invoice number and the number of transactions for each invoice . [system description] Step 1 : for each row in invoices table , find the corresponding rows in financial transactions table . Step 2 : find each value of invoices 's invoice number of the results of step 1 along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , consider the rating stars greater than or equals 4 conditions in place of the rating date equals 2011-01-20 or rating stars equals 2 conditions . make sure no repetition in the results . order the results ascending by year in place of ordering descending by rating date . [question] In what years did a movie receive a 4 or 5 star rating , and list the years from oldest to most recently ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the year of the results of step 1 whose rating stars equals 2 or rating date equals " 2011-01-20 " ordered descending by rating date . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
consider the first name equals Janessa and last name equals Sawayn conditions in place of the first name equals Lincoln and last name equals Mertz conditions . find date left staff in place of date of birth . [question] When did the staff member Janessa Sawayn leave the company ? [system description] find the date of birth in staff table whose first name equals " Lincoln " and last name equals " Mertz " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
consider the first name equals Ludie conditions in place of the first name equals Simeon conditions . [question] How many employees have a first name of Ludie ? [system description] find the number of rows in staff table whose first name equals " Simeon " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Ludie ) [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 3 , additionally find title . find rating stars in place of maximum rating stars . you should not find the smallest of the results . show me all the results . [question] For each director , what is the title and score of their most poorly rated movie ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the number of rows of each value of director of the results of step 1 . Step 3 : find the director , maximum rating stars , minimum rating stars of the results of step 1 with smallest value in the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally use the information from the financial transactions table besides the accounts table . [question] Show the account name , id and the number of transactions for each account . [system description] find each value of account id in accounts table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , consider the rating stars greater than or equals 4 conditions in place of the rating date equals 2011-01-22 conditions . make sure no repetition in the results . order the results ascending . [question] Find all years that have a movie that received a rating of 4 or 5 , and sort them in increasing order of year . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the year of the results of step 1 whose rating date equals " 2011-01-22 " or rating date equals " 2011-01-22 " ordered descending by year . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the movie table . in step 2 , consider the name equals Brittany Harris conditions in place of the name equals Ashley White conditions . in step 3 , use rating table in place of movie table . find for each value of rating 's movie id . find average rating stars and rating 's movie id in place of average title . [question] What is the average rating for each movie that has never been reviewed by Brittany Harris ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the movie 's movie id of the results of step 1 whose name equals " Ashley White " . Step 3 : find the average title in movie table whose movie 's movie id not one of the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Brittany Harris ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the financial transactions table besides the accounts table . in step 2 , make sure that the corresponding value in step 1 greater than or equals 4 . [question] What are the ids and names of accounts with 4 or more transactions ? [system description] Step 1 : find the number of rows of each value of account id in accounts table . Step 2 : find the account id and account name in accounts table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , additionally find title . [question] What are the names of directors who directed movies with 5 star rating ? Also return the title of these movies . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the director and director of the results of step 1 whose rating stars equals 5 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the movie table . in step 2 , find the number of rows for each value of rating 's movie id . in step 3 , make sure that the corresponding value in step 2 greater than or equals 2 . find rating 's movie id in place of title . [question] Find the average rating star for each movie that received at least 2 ratings . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the average rating stars of each value of movie 's movie id of the results of step 1 . Step 3 : find the average rating stars and title of the results of step 1 whose corresponding value in step 2 is greater than or equals 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , use staff table in place of customers table in step 2 , consider the staff 's first name equals Janessa and staff 's last name equals Sawayn conditions in place of the customers 's first name equals Estelle conditions . [question] In what city does Janessa Sawayn live ? [system description] Step 1 : for each row in customers table , find the corresponding rows in addresses table . Step 2 : find the city of the results of step 1 whose first name equals " Estelle " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
consider the first name equals Janessa and last name equals Sawayn conditions in place of the first name equals Queenie conditions . [question] What is the nickname of the employee named Janessa Sawayn ? [system description] find the nickname in staff table whose first name equals " Queenie " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , do not find for each value of director . in step 2 , additionally make sure that title not equals title . [question] For directors who had more than one movie , return the titles and produced years of all movies directed by them . [system description] Step 1 : find the number of rows of each value of director in movie table . Step 2 : find the title and year in movie table whose corresponding value in step 1 is greater than 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the financial transactions table besides the accounts table . in step 2 , make sure that the corresponding value in step 1 greater than or equals 4 . [question] Show the account id and name with at least 4 transactions . [system description] Step 1 : find the number of rows of each value of account id in accounts table . Step 2 : find the account id and account name in accounts table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , use financial transactions table in place of accounts table . [question] Show the account id with most number of transactions . [system description] Step 1 : find the number of rows of each value of account id in accounts table . Step 2 : find the account id in accounts table with largest value in the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the director equals James Cameron and year greater than 2000 conditions in place of the year greater than 1939 and director greater than Victor Fleming conditions . [question] What are the titles of all movies that James Cameron directed after 2000 ? [system description] find the title in movie table whose director greater than " Victor Fleming " and year greater than 1939 . [schema] [T] movie [C] movie id [C] title [C] year [C] director ( James Cameron ) [T] reviewer [C] reviewer id [C] name ( James Cameron ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the name equals Sarah Martinez conditions in place of the name equals Ashley White conditions . make sure no repetition in the results . [question] Find the names of all directors whose movies are rated by Sarah Martinez . [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the director of the results of step 1 whose name equals " Ashley White " . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Sarah Martinez ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , use staff table in place of customers table in step 2 , consider the staff 's first name equals Janessa and staff 's last name equals Sawayn conditions in place of the customers 's first name equals Omer conditions . [question] In which country and state does Janessa Sawayn live ? [system description] Step 1 : for each row in customers table , find the corresponding rows in addresses table . Step 2 : find the country and state province county of the results of step 1 whose first name equals " Omer " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , do not use the movie table . in step 3 , consider the name equals Brittany Harris conditions in place of the name equals Sarah Martinez conditions . in step 4 , find for each value of rating 's movie id . additionally find rating 's movie id . [question] Find the average rating star for each movie that are not reviewed by Brittany Harris . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : for each row in reviewer table , find the corresponding rows in rating table . Step 3 : find the rating 's movie id of the results of step 2 whose name equals " Sarah Martinez " . Step 4 : find the average rating stars and average rating stars of the results of step 1 whose movie 's movie id not one of the results of step 3 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Brittany Harris ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the detention table besides the reference detention type table . [question] What are the code and description of the least frequent detention type ? [system description] Step 1 : find the number of rows of each value of detention type code in reference detention type table . Step 2 : find the detention type code and detention type description in reference detention type table with smallest value in the results of step 1 . [schema] [T] reference address types [C] address type code [C] address type description [T] reference detention type [C] detention type code [C] detention type description [T] reference incident type [C] incident type code [C] incident type description [T] addresses [C] address id [C] line 1 [C] line 2 [C] line 3 [C] city [C] zip postcode [C] state province county [C] country [C] other address details [T] students [C] student id [C] address id [C] first name [C] middle name [C] last name [C] cell mobile number [C] email address [C] date first rental [C] date left university [C] other student details [T] teachers [C] teacher id [C] address id [C] first name [C] middle name [C] last name [C] gender [C] cell mobile number [C] email address [C] other details [T] assessment notes [C] notes id [C] student id [C] teacher id [C] date of notes [C] text of notes [C] other details [T] behavior incident [C] incident id [C] incident type code [C] student id [C] date incident start [C] date incident end [C] incident summary [C] recommendations [C] other details [T] detention [C] detention id [C] detention type code [C] teacher id [C] datetime detention start [C] datetime detention end [C] detention summary [C] other details [T] student addresses [C] student id [C] address id [C] date address from [C] date address to [C] monthly rental [C] other details [T] students in detention [C] student id [C] detention id [C] incident id
in step 1 , use rating table in place of movie table . in step 2 , do not use the movie table . in step 3 , consider the name equals Brittany Harris conditions in place of the name equals Daniel Lewis conditions . [question] What are the ids of the movies that are not reviewed by Brittany Harris . [system description] Step 1 : find the movie 's movie id in movie table . Step 2 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 3 : find the movie 's movie id of the results of step 2 whose name equals " Daniel Lewis " . Step 4 : show the rows that are in the results of step 1 but not in the results of step 3 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Brittany Harris ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the first name equals Carole and last name equals Bernhard conditions in place of the first name equals Jordy conditions . [question] What is the zip code of the customer Carole Bernhard ? [system description] Step 1 : for each row in customers table , find the corresponding rows in addresses table . Step 2 : find the zip postcode of the results of step 1 whose first name equals " Jordy " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Carole ) [C] last name ( Bernhard ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the staff table besides the addresses table . [question] In which city do the most employees live and how many of them live there ? [system description] Step 1 : find the number of rows of each value of city in addresses table . Step 2 : find the city and number of rows in addresses table with largest value in the results of step 1 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the students table besides the addresses table . in step 2 , additionally use the information from the teachers table besides the addresses table . find line 1 in place of line 2 . [question] What are the line 1 of addresses shared by some students and some teachers ? [system description] Step 1 : find the line 1 in addresses table . Step 2 : find the line 2 in addresses table . Step 3 : show the rows that are in both the results of step 1 and step 2 . [schema] [T] reference address types [C] address type code [C] address type description [T] reference detention type [C] detention type code [C] detention type description [T] reference incident type [C] incident type code [C] incident type description [T] addresses [C] address id [C] line 1 [C] line 2 [C] line 3 [C] city [C] zip postcode [C] state province county [C] country [C] other address details [T] students [C] student id [C] address id [C] first name [C] middle name [C] last name [C] cell mobile number [C] email address [C] date first rental [C] date left university [C] other student details [T] teachers [C] teacher id [C] address id [C] first name [C] middle name [C] last name [C] gender [C] cell mobile number [C] email address [C] other details [T] assessment notes [C] notes id [C] student id [C] teacher id [C] date of notes [C] text of notes [C] other details [T] behavior incident [C] incident id [C] incident type code [C] student id [C] date incident start [C] date incident end [C] incident summary [C] recommendations [C] other details [T] detention [C] detention id [C] detention type code [C] teacher id [C] datetime detention start [C] datetime detention end [C] detention summary [C] other details [T] student addresses [C] student id [C] address id [C] date address from [C] date address to [C] monthly rental [C] other details [T] students in detention [C] student id [C] detention id [C] incident id
in step 1 , additionally use the information from the rating table besides the movie table . in step 2 , additionally find rating 's movie id . [question] What is the name of the movie that is rated by most of times ? [system description] Step 1 : find the number of rows of each value of movie id in movie table . Step 2 : find the title in movie table with largest value in the results of step 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , make sure no repetition in the results . in step 3 , consider the name equals Chris Jackson conditions in place of the name equals Elizabeth Thomas conditions . [question] Find the titles of all movies not reviewed by Chris Jackson . [system description] Step 1 : find the title in movie table . Step 2 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 3 : find the title of the results of step 2 whose name equals " Elizabeth Thomas " . Step 4 : show the rows that are in the results of step 1 but not in the results of step 3 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Chris Jackson ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
consider the lesson status code equals Cancelled conditions in place of the lesson status code equals Completed conditions . find number of rows in place of number of lesson status code . [question] How many lessons have been cancelled ? [system description] find the number of lesson status code in lessons table whose lesson status code equals " Completed " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code ( Cancelled ) [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , additionally find invoices 's order id . [question] What are the invoice dates , order ids , and order details for all invoices ? [system description] Step 1 : for each row in invoices table , find the corresponding rows in orders table . Step 2 : find the invoice date , invoice date , order details of the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the first name equals Carole and last name equals Bernhard conditions in place of the first name equals Ray and last name equals Tromp conditions . find date became customer in place of date of birth . [question] When did customer with first name as Carole and last name as Bernhard became a customer ? [system description] find the date of birth in customers table whose first name equals " Ray " and last name equals " Tromp " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Carole ) [C] last name ( Bernhard ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
consider the state province county equals Georgia conditions in place of the state province county equals WestVirginia conditions . [question] How many staff live in state Georgia ? [system description] find the number of rows in addresses table whose state province county equals " WestVirginia " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county ( Georgia ) [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the customer payments table besides the customers table . in step 2 , make sure that the corresponding value in step 1 greater than 2 . [question] List first name and last name of customers that have more than 2 payments . [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the first name and last name in customers table whose corresponding value in step 1 is greater than 1 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 3 , additionally find orders 's customer id . [question] What is the customer last name , id and phone number with most number of orders ? [system description] Step 1 : for each row in customers table , find the corresponding rows in orders table . Step 2 : find the number of rows of each value of orders 's customer id of the results of step 1 . Step 3 : find the customer last name , customer last name , phone number of the results of step 1 with largest value in the results of step 2 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the first name equals Janessa and last name equals Sawayn conditions in place of the date of birth equals 1994-05-17 05:32:11 and first name equals Titus conditions . [question] When did the staff member with first name as Janessa and last name as Sawayn join the company ? [system description] find the date joined staff in staff table whose first name equals " Titus " and date of birth equals " 1994-05-17 05:32:11 " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , do not use the orders table . [question] Show order ids and the total quantity in each order . [system description] Step 1 : for each row in order items table , find the corresponding rows in orders table . Step 2 : find each value of orders 's order id of the results of step 1 along with the summation of product quantity of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the first name equals Janessa and last name equals Sawayn conditions in place of the first name equals Eulalia and last name equals Herzog conditions . find date joined staff in place of date of birth . [question] When did the staff member named Janessa Sawayn join the company ? [system description] find the date of birth in staff table whose first name equals " Eulalia " and last name equals " Herzog " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
consider the director equals James Cameron and year greater than 2000 conditions in place of the year greater than 2009 and director equals Robert Wise conditions . [question] What is the name of the movie produced after 2000 and directed by James Cameron ? [system description] find the title in movie table whose year greater than 2009 and director equals " Robert Wise " . [schema] [T] movie [C] movie id [C] title [C] year [C] director ( James Cameron ) [T] reviewer [C] reviewer id [C] name ( James Cameron ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the customer payments table besides the customers table . in step 2 , make sure that the corresponding value in step 1 greater than 2 . [question] What are the first and last names of all customers with more than 2 payments ? [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the first name and last name in customers table whose corresponding value in step 1 is greater than 1 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , additionally make sure that director equals name . do not find for each value of name . find title and rating stars in place of director and number of rows . make sure no repetition in the results . [question] For any rating where the name of reviewer is the same as the director of the movie , return the reviewer name , movie title , and number of stars . [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find each value of name of the results of step 1 along with the number of the corresponding rows to each value . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally use the information from the rating table besides the movie table . additionally make sure that year is equals maximum year movie . additionally find maximum rating stars . find year in place of maximum year . find year in place of minimum year . you should not find the largest of the results . show me all the results . [question] What is the maximum stars and year for the most recent movie ? [system description] find the maximum year and minimum year in movie table with largest value of year . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally make sure that title not equals title . additionally order the results by director . [question] For all directors who directed more than one movie , return the titles of all movies directed by them , along with the director name . Sort by director name , then movie title . [system description] find the director and title in movie table ordered ascending by title and title . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
consider the first name equals Marina or last name equals Kohler conditions in place of the first name equals Millie or last name equals Terry conditions . find cell mobile phone number in place of phone number . [question] What is the status code , phone number , and email address of the customer whose last name is Kohler or whose first name is Marina ? [system description] find the customer status code , phone number , email address in customers table whose last name equals " Terry " or first name equals " Millie " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Marina ) [C] last name ( Kohler ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally make sure that year is equals maximum year movie . you should not find the largest of the results . show me all the results . [question] What is the name of the most recent movie ? [system description] find the title in movie table with largest value of year . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , additionally make sure that year is equals minimum year movie . do not find for each value of title . in step 3 , find average rating stars in place of average rating date . you should not find the largest of the results . show me all the results . [question] For the oldest movie listed , what is its average rating and title ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the average rating date of each value of title of the results of step 1 . Step 3 : find the title and average rating date of the results of step 1 with largest value in the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally find minimum transaction amount and maximum transaction amount . [question] Return the average , minimum , maximum , and total transaction amounts . [system description] find the average transaction amount , summation of transaction amount , summation of transaction amount , summation of transaction amount in financial transactions table . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the first name equals Ludie conditions in place of the first name equals Eulalia conditions . [question] How many staff have the first name Ludie ? [system description] find the number of rows in staff table whose first name equals " Eulalia " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Ludie ) [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the accounts table besides the customers table . [question] Return the id and full name of the customer with the most accounts . [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the customer id , customer first name , customer last name in customers table with largest value in the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , use customers table in place of staff table . find customers 's last name in place of staff 's last name . in step 2 , use staff table in place of customers table . find staff 's last name in place of customers 's last name . [question] Which last names are both used by customers and by staff ? [system description] Step 1 : find the staff 's last name in staff table . Step 2 : find the customers 's last name in customers table . Step 3 : show the rows that are in both the results of step 1 and step 2 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , consider the first name equals Ray conditions in place of the first name equals Leif conditions . find number of rows in place of number of lesson id . [question] How many lessons did the customer with the first name Ray take ? [system description] Step 1 : for each row in customers table , find the corresponding rows in lessons table . Step 2 : find the number of lesson id of the results of step 1 whose first name equals " Leif " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Ray ) [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 3 , make sure that the corresponding value in step 2 greater than 2 . [question] What is the order id and order details for the order more than two invoices . [system description] Step 1 : for each row in invoices table , find the corresponding rows in orders table . Step 2 : find the number of rows of each value of invoices 's order id of the results of step 1 . Step 3 : find the invoices 's order id and order details of the results of step 1 whose corresponding value in step 2 is greater than 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , additionally use the information from the rating table besides the reviewer table . find for each value of rating 's reviewer id whose number of rows greater than or equals 3 . [question] Find the names of all reviewers who have contributed three or more ratings . [system description] Step 1 : find the number of rows of each value of name in reviewer table . Step 2 : find the name in reviewer table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the staff table besides the addresses table . in step 2 , make sure that the corresponding value in step 1 between 2 and 4 . [question] What are the names of the states that have 2 to 4 employees living there ? [system description] Step 1 : find the number of rows of each value of state province county in addresses table . Step 2 : find the state province county in addresses table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the financial transactions table besides the invoices table . [question] What is the invoice number and invoice date for the invoice with most number of transactions ? [system description] Step 1 : find the number of rows of each value of invoice number in invoices table . Step 2 : find the invoice number and invoice date in invoices table with largest value in the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , do not use the reviewer table . in step 2 , find for each value of rating 's movie id in place of name . in step 3 , additionally find rating 's movie id . [question] What is the name of the movie that has been reviewed the most ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the number of rows of each value of name of the results of step 1 . Step 3 : find the title of the results of step 1 with largest value in the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the customer last name equals Keeling and customer first name equals Meaghan conditions in place of the customer first name equals Neoma conditions . [question] What are the names and other details for accounts corresponding to the customer named Meaghan Keeling ? [system description] Step 1 : for each row in customers table , find the corresponding rows in accounts table . Step 2 : find the account name and other account details of the results of step 1 whose customer first name equals " Neoma " . [schema] [T] customers [C] customer id [C] customer first name ( Meaghan ) [C] customer middle initial [C] customer last name ( Keeling ) [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , additionally use the information from the movie table besides the rating table . consider the director equals James Cameron conditions in place of the rating stars greater than or equals 3 conditions . [question] What are the titles and directors of all movies that have a rating higher than the average James Cameron film rating ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the average rating stars in rating table whose rating stars greater than or equals 3 . Step 3 : find the title and director of the results of step 1 whose rating stars greater than the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director ( James Cameron ) [T] reviewer [C] reviewer id [C] name ( James Cameron ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the movie table . in step 2 , find the number of rows for each value of rating 's movie id . in step 3 , make sure that the corresponding value in step 2 greater than or equals 2 . find rating 's movie id in place of average title . [question] For each movie that received more than 3 reviews , what is the average rating ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the average rating stars of each value of rating 's movie id of the results of step 1 . Step 3 : find the average title and average rating stars of the results of step 1 whose corresponding value in step 2 is greater than 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , additionally make sure that year is equals maximum year movie . find maximum rating stars in place of maximum rating date . find year in place of minimum year . you should not find the largest of the results . show me all the results . [question] What is highest rating for the most recent movie and when was it released ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the maximum rating date and minimum year of the results of step 1 with largest value of year . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally use the information from the lessons table besides the customers table . consider the last name equals Goodwin and first name equals Rylan and lesson status code equals Completed conditions in place of the first name equals Dianna and last name equals Trantow conditions . [question] How many lessons taken by customer with first name as Rylan and last name as Goodwin were completed ? [system description] find the number of rows in customers table whose first name equals " Dianna " and last name equals " Trantow " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Rylan ) [C] last name ( Goodwin ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code ( Completed ) [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , consider the first name like % a % conditions in place of the first name like Jedidiah conditions . [question] How many lessons were taught by a staff member whose first name has the letter ' a ' in it ? [system description] Step 1 : for each row in staff table , find the corresponding rows in lessons table . Step 2 : find the number of rows of the results of step 1 whose first name like " Jedidiah " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , additionally find rating stars . order the results by name and rating stars in place of year . [question] What is the reviewer name , film title , movie rating , and rating date for every movie ordered by reviewer name , movie title , then finally rating ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the name , title , rating date of the results of step 1 ordered ascending by year and title . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , additionally make sure that year is equals minimum year movie . find title in place of average title . you should not find the largest of the results . show me all the results . [question] What is the average rating stars and title for the oldest movie ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the average rating stars and average title of the results of step 1 with largest value of year . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
use students in detention table in place of students table . find number of different students in detention 's student id in place of number of students 's student id . [question] How many distinct students have been in detention ? [system description] find the number of student id in students table . [schema] [T] reference address types [C] address type code [C] address type description [T] reference detention type [C] detention type code [C] detention type description [T] reference incident type [C] incident type code [C] incident type description [T] addresses [C] address id [C] line 1 [C] line 2 [C] line 3 [C] city [C] zip postcode [C] state province county [C] country [C] other address details [T] students [C] student id [C] address id [C] first name [C] middle name [C] last name [C] cell mobile number [C] email address [C] date first rental [C] date left university [C] other student details [T] teachers [C] teacher id [C] address id [C] first name [C] middle name [C] last name [C] gender [C] cell mobile number [C] email address [C] other details [T] assessment notes [C] notes id [C] student id [C] teacher id [C] date of notes [C] text of notes [C] other details [T] behavior incident [C] incident id [C] incident type code [C] student id [C] date incident start [C] date incident end [C] incident summary [C] recommendations [C] other details [T] detention [C] detention id [C] detention type code [C] teacher id [C] datetime detention start [C] datetime detention end [C] detention summary [C] other details [T] student addresses [C] student id [C] address id [C] date address from [C] date address to [C] monthly rental [C] other details [T] students in detention [C] student id [C] detention id [C] incident id
in step 2 , additionally find rating date . additionally order the results by rating stars . [question] Return reviewer name , movie title , stars , and ratingDate . And sort the data first by reviewer name , then by movie title , and lastly by number of stars . [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the name , title , rating stars of the results of step 1 ordered ascending by name and title . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not find for each value of director . in step 2 , additionally make sure that title not equals title . [question] For each director who directed more than one movie , what are the titles and dates of release for all those movies ? [system description] Step 1 : find the number of rows of each value of director in movie table . Step 2 : find the title and year in movie table whose corresponding value in step 1 is greater than 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the first name like % a % conditions in place of the first name like Kaitlin conditions . [question] How many lessons taught by staff whose first name has letter ' a ' in it ? [system description] Step 1 : for each row in staff table , find the corresponding rows in lessons table . Step 2 : find the number of rows of the results of step 1 whose first name like " Kaitlin " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally use the information from the rating table and movie table besides the reviewer table . additionally make sure that title equals Gone with the Wind . make sure no repetition in the results . [question] What are the names of all the different reviewers who rates Gone with the Wind ? [system description] find the name in reviewer table . [schema] [T] movie [C] movie id [C] title ( Gone with the Wind ) [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , use rating table in place of movie table . in step 2 , do not use the movie table . [question] What are the ids of all moviest hat have not been reviewed by Britanny Harris ? [system description] Step 1 : find the movie 's movie id in movie table . Step 2 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 3 : find the movie 's movie id of the results of step 2 whose name equals " Brittany Harris " . Step 4 : show the rows that are in the results of step 1 but not in the results of step 3 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the staff table . in step 2 , consider the state province county equals Georgia conditions in place of the state province county equals WestVirginia conditions . [question] How many employees live in Georgia ? [system description] Step 1 : for each row in staff table , find the corresponding rows in addresses table . Step 2 : find the number of rows of the results of step 1 whose state province county equals " WestVirginia " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county ( Georgia ) [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally find minimum transaction amount and maximum transaction amount . [question] What is the average , minimum , maximum , and total transaction amount ? [system description] find the average transaction amount , summation of transaction amount , summation of transaction amount , summation of transaction amount in financial transactions table . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , consider the customer first name equals Meaghan conditions in place of the customer first name equals Kieran conditions . additionally find date account opened . [question] Show the id , the account name , and other account details for all accounts by the customer with first name 'Meaghan ' . [system description] Step 1 : for each row in customers table , find the corresponding rows in accounts table . Step 2 : find the account id , account name , other account details of the results of step 1 whose customer first name equals " Kieran " . [schema] [T] customers [C] customer id [C] customer first name ( Meaghan ) [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
additionally use the information from the financial transactions table besides the accounts table . additionally find financial transactions 's account id . [question] Return the names and ids of each account , as well as the number of transactions . [system description] find each value of account id in accounts table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , additionally use the information from the orders table besides the customers table . [question] Return the last name , id and phone number of the customer who has made the greatest number of orders . [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the customer last name , customer id , phone number in customers table with largest value in the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
find for each value of order id in place of order item id . find order id in place of order item id . [question] How many order items correspond to each order id ? [system description] find each value of order item id in order items table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
you should not find the smallest of the results . show me all the results . [question] What is the lowest and highest rating star ? [system description] find the maximum rating stars and minimum rating stars in rating table with smallest value of rating stars . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
consider the first name equals Janessa and last name equals Sawayn conditions in place of the first name equals Ludie and date of birth equals 1997-03-29 10:55:45 conditions . find date left staff in place of date joined staff . [question] When did the staff member with first name as Janessa and last name as Sawayn leave the company ? [system description] find the date joined staff in staff table whose first name equals " Ludie " and date of birth equals " 1997-03-29 10:55:45 " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , consider the last name equals Goodwin and first name equals Rylan and lesson status code equals Completed conditions in place of the first name equals Dianna and last name equals Spinka conditions . find number of rows in place of number of lesson id . [question] How many lessons did the customer Ryan Goodwin complete ? [system description] Step 1 : for each row in customers table , find the corresponding rows in lessons table . Step 2 : find the number of lesson id of the results of step 1 whose first name equals " Dianna " and last name equals " Spinka " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name ( Goodwin ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code ( Completed ) [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , consider the rating date equals null conditions in place of the rating date equals 2011-01-22 conditions . make sure no repetition in the results . [question] Find the names of all reviewers who have ratings with a NULL value for the date . [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table . Step 2 : find the name of the results of step 1 whose rating date equals " 2011-01-22 " . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the orders table . [question] Give the order ids for all orders , as well as the total product quantity in each . [system description] Step 1 : for each row in order items table , find the corresponding rows in orders table . Step 2 : find each value of orders 's order id of the results of step 1 along with the summation of product quantity of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , do not use the reviewer table . [question] How many movie reviews does each director get ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find each value of director of the results of step 1 along with the number of the corresponding rows to each value . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the accounts table besides the customers table . in step 2 , make sure that the corresponding value in step 1 greater than or equals 2 . [question] Show first name and id for all customers with at least 2 accounts . [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the customer first name and customer id in customers table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
use financial transactions table in place of accounts table . do not find for each value of accounts 's account id . [question] How many transaction does each account have ? Show the number and account id . [system description] find each value of account id in accounts table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the first name equals Janessa and last name equals Sawayn conditions in place of the first name equals Kaitlin and date of birth equals 2007-06-11 20:03:28 conditions . do not return first name . [question] What is the birthday of the staff member with first name as Janessa and last name as Sawayn ? [system description] find the first name and date of birth in staff table whose first name equals " Kaitlin " and date of birth equals " 2007-06-11 20:03:28 " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , additionally make sure that director not equals null . find for each value of director . additionally find maximum rating stars and director . [question] For each director , what are the titles and ratings for all the movies they reviewed ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the title and rating stars of the results of step 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 3 , additionally find average rating stars . [question] What are the movie titles with the highest average rating and what are those ratings ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the average rating stars of each value of rating 's movie id of the results of step 1 . Step 3 : find the title and title of the results of step 1 with largest value in the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the first name equals Ray conditions in place of the first name equals Leif conditions . find number of rows in place of number of lesson id . [question] How many lesson does customer with first name Ray took ? [system description] Step 1 : for each row in customers table , find the corresponding rows in lessons table . Step 2 : find the number of lesson id of the results of step 1 whose first name equals " Leif " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Ray ) [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally use the information from the student addresses table besides the addresses table . find for each value of student addresses 's address id . find average monthly rental in place of line 2 . [question] What are the line 1 and average monthly rentals of all student addresses ? [system description] find the line 1 and line 2 in addresses table . [schema] [T] reference address types [C] address type code [C] address type description [T] reference detention type [C] detention type code [C] detention type description [T] reference incident type [C] incident type code [C] incident type description [T] addresses [C] address id [C] line 1 [C] line 2 [C] line 3 [C] city [C] zip postcode [C] state province county [C] country [C] other address details [T] students [C] student id [C] address id [C] first name [C] middle name [C] last name [C] cell mobile number [C] email address [C] date first rental [C] date left university [C] other student details [T] teachers [C] teacher id [C] address id [C] first name [C] middle name [C] last name [C] gender [C] cell mobile number [C] email address [C] other details [T] assessment notes [C] notes id [C] student id [C] teacher id [C] date of notes [C] text of notes [C] other details [T] behavior incident [C] incident id [C] incident type code [C] student id [C] date incident start [C] date incident end [C] incident summary [C] recommendations [C] other details [T] detention [C] detention id [C] detention type code [C] teacher id [C] datetime detention start [C] datetime detention end [C] detention summary [C] other details [T] student addresses [C] student id [C] address id [C] date address from [C] date address to [C] monthly rental [C] other details [T] students in detention [C] student id [C] detention id [C] incident id
in step 1 , do not use the rating table and reviewer table . in step 2 , do not find for each value of director . in step 3 , additionally make sure that title not equals title . find title in place of name . order the results ascending by title and director . [question] For all directors who have directed more than one movie , what movies have they directed and what are their names ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the number of rows of each value of director of the results of step 1 . Step 3 : find the director and name of the results of step 1 whose corresponding value in step 2 is greater than 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally find middle name . [question] List the first name middle name and last name of all staff . [system description] find the first name and last name in staff table . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , additionally find invoices 's order id . [question] Show invoice dates and order id and details for all invoices . [system description] Step 1 : for each row in invoices table , find the corresponding rows in orders table . Step 2 : find the invoice date , order details , order details of the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
use order items table in place of products table . find for each value of order items 's product id . find number of different order id and order items 's product id in place of number of products 's product id . [question] How many distinct order ids correspond to each product ? [system description] find the number of product id in products table . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
use customers table in place of customer payments table . find minimum amount outstanding , maximum amount outstanding , and average amount outstanding in place of average amount payment , maximum amount payment , and minimum amount payment . [question] What is the maximum , minimum , and average amount of money outsanding for all customers ? [system description] find the maximum amount payment , minimum amount payment , average amount payment in customer payments table . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , use customers table in place of staff table . find customers 's last name in place of staff 's last name . in step 2 , use staff table in place of customers table . find staff 's last name in place of customers 's last name . [question] What are the last names that are used by customers and staff ? [system description] Step 1 : find the staff 's last name in staff table . Step 2 : find the customers 's last name in customers table . Step 3 : show the rows that are in both the results of step 1 and step 2 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the staff table besides the addresses table . [question] Which city lives most of staffs ? List the city name and number of staffs . [system description] Step 1 : find the number of rows of each value of city in addresses table . Step 2 : find the city and number of rows in addresses table with largest value in the results of step 1 . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , use staff table in place of customers table in step 2 , consider the staff 's first name equals Janessa and staff 's last name equals Sawayn conditions in place of the customers 's first name equals Ray conditions . [question] What is the average price for a lesson taught by Janessa Sawayn ? [system description] Step 1 : for each row in customers table , find the corresponding rows in lessons table . Step 2 : find the average price of the results of step 1 whose first name equals " Ray " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , find for each value of director . additionally find minimum rating stars and rating stars . you should not find the smallest of the results . show me all the results . [question] Find the title and score of the movie with the lowest rating among all movies directed by each director . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the title and director of the results of step 1 with smallest value of rating stars . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , make sure no repetition in the results . in step 3 , consider the name equals Chris Jackson conditions in place of the name equals Sarah Martinez conditions . [question] What are the titles of all movies that were not reviewed by Chris Jackson ? [system description] Step 1 : find the title in movie table . Step 2 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 3 : find the title of the results of step 2 whose name equals " Sarah Martinez " . Step 4 : show the rows that are in the results of step 1 but not in the results of step 3 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Chris Jackson ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , find for each value of reviewer id . additionally find minimum rating stars and reviewer id . you should not find the smallest of the results . show me all the results . [question] For each reviewer id , what is the title and rating for the movie with the smallest rating ? [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the title and rating stars of the results of step 1 with smallest value of rating stars . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
consider the first name equals Carole and last name equals Bernhard conditions in place of the first name equals Omer and last name equals Trantow conditions . find date became customer in place of date of birth . [question] When did Carole Bernhard first become a customer ? [system description] find the date of birth in customers table whose first name equals " Omer " and last name equals " Trantow " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Carole ) [C] last name ( Bernhard ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , find for each value of name in place of reviewer 's reviewer id . [question] What is the average number of stars that each reviewer awards for a movie ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table . Step 2 : find each value of reviewer 's reviewer id of the results of step 1 along with the average rating stars and name of the corresponding rows to each value . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the accounts table . in step 2 , do not find for each value of accounts 's account id . [question] Count the number of financial transactions that correspond to each account id . [system description] Step 1 : for each row in financial transactions table , find the corresponding rows in accounts table . Step 2 : find each value of accounts 's account id of the results of step 1 along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , additionally use the information from the accounts table besides the customers table . [question] What is the customer id , first and last name with most number of accounts . [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the customer id , customer first name , customer last name in customers table with largest value in the results of step 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , use rating table in place of reviewer table . in step 2 , consider the rating stars equals 4 conditions in place of the rating stars equals 5 conditions . [question] What are the ids of all reviewers who did not give 4 stars ? [system description] Step 1 : find the reviewer 's reviewer id in reviewer table . Step 2 : find the rating 's reviewer id in rating table whose rating stars equals 5 . Step 3 : show the rows that are in the results of step 1 but not in the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
consider the first name equals Janessa and last name equals Sawayn conditions in place of the date joined staff equals 2018-01-02 12:24:24 conditions . [question] What is the date of birth for the staff member named Janessa Sawayn ? [system description] find the date of birth in staff table whose date joined staff equals " 2018-01-02 12:24:24 " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally use the information from the accounts table besides the customers table . additionally find customer last name . [question] Show id , first name and last name for all customers and the number of accounts . [system description] find each value of customer id in customers table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , find for each value of reviewer id . additionally find minimum rating stars and reviewer id . you should not find the smallest of the results . show me all the results . [question] Find the title and star rating of the movie that got the least rating star for each reviewer . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : find the title and rating stars of the results of step 1 with smallest value of rating stars . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the first name equals Janessa and last name equals Sawayn and nickname like % s % conditions in place of the first name like Eulalia and last name like Jast conditions . [question] List lesson id of all lessons taught by staff with first name as Janessa , last name as Sawayn and nickname containing letter 's ' . [system description] Step 1 : for each row in staff table , find the corresponding rows in lessons table . Step 2 : find the lesson id and lesson id of the results of step 1 whose first name like " Eulalia " and last name like " Jast " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the accounts table besides the customers table . in step 2 , make sure that the corresponding value in step 1 greater than or equals 2 . [question] What are the first names and ids for customers who have two or more accounts ? [system description] Step 1 : find the number of rows of each value of customer id in customers table . Step 2 : find the customer first name and customer id in customers table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
additionally find account name and other account details . [question] What are the ids , date opened , name , and other details for all accounts ? [system description] find the account id , date account opened , date account opened in accounts table . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , do not use the customers table and lessons table . in step 2 , consider the staff 's first name equals Janessa and staff 's last name equals Sawayn conditions in place of the customers 's first name equals Amya and staff 's last name equals Weissnat conditions . [question] What is the zip code of the hosue of the employee named Janessa Sawayn ? [system description] Step 1 : for each row in customers table , find the corresponding rows in lessons table and in staff table and in addresses table . Step 2 : find the zip postcode of the results of step 1 whose customers 's first name equals " Amya " and staff 's last name equals " Weissnat " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 2 , use accounts table in place of customers table . [question] What are the customer ids for customers who do not have an account ? [system description] Step 1 : find the customer id in customers table . Step 2 : find the customer id in customers table . Step 3 : show the rows that are in the results of step 1 but not in the results of step 2 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
use order items table in place of products table . find for each value of order id . find order id and number of different order items 's product id in place of number of products 's product id . [question] How many different products correspond to each order id ? [system description] find the number of product id in products table . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , do not use the addresses table and customers table . in step 2 , consider the lesson status code equals Cancelled conditions in place of the state province county equals Georgia conditions . [question] How many lessons were in cancelled state ? [system description] Step 1 : for each row in addresses table , find the corresponding rows in customers table and in lessons table . Step 2 : find the number of rows of the results of step 1 whose state province county equals " Georgia " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code ( Cancelled ) [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
in step 1 , additionally use the information from the rating table besides the reviewer table . do not find for each value of name . in step 2 , additionally make sure that rating stars greater than 3 . [question] Find the names of reviewers who had given higher than 3 star ratings . [system description] Step 1 : find the number of rows of each value of name in reviewer table . Step 2 : find the name in reviewer table whose corresponding value in step 1 is greater than 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
use order items table in place of products table . find number of different order id in place of number of products 's product id . [question] Show the product ids and the number of unique orders containing each product . [system description] find each value of product id in products table along with the number of product id of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , consider the first name equals Janessa and last name equals Sawayn and nickname like % s % conditions in place of the nickname equals ynader and nickname like gabe21 conditions . [question] What are the the lesson ids of all staff taught by Janessa Sawayn whose nickname has the letter s ? [system description] Step 1 : for each row in staff table , find the corresponding rows in lessons table . Step 2 : find the lesson id of the results of step 1 whose nickname like " gabe21 " and nickname equals " ynader " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally make sure that year is equals maximum year movie . you should not find the largest of the results . show me all the results . [question] What is the title of the newest movie ? [system description] find the title in movie table with largest value of year . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the rating table and reviewer table . in step 2 , consider the title equals Avatar conditions in place of the director equals George Lucas conditions . find director in place of name . [question] Who directed Avatar ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the name of the results of step 1 whose director equals " George Lucas " . [schema] [T] movie [C] movie id [C] title ( Avatar ) [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the movie table . in step 2 , consider the title equals Gone with the Wind conditions in place of the rating stars equals 4 conditions . make sure no repetition in the results . [question] Find the names of all reviewers who rated Gone with the Wind . [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table . Step 2 : find the name of the results of step 1 whose rating stars equals 4 . [schema] [T] movie [C] movie id [C] title ( Gone with the Wind ) [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 3 , make sure that the corresponding value in step 2 greater than 2 . [question] Return the order ids and details for orderes with two or more invoices . [system description] Step 1 : for each row in invoices table , find the corresponding rows in orders table . Step 2 : find the number of rows of each value of invoices 's order id of the results of step 1 . Step 3 : find the invoices 's order id and order details of the results of step 1 whose corresponding value in step 2 is greater than or equals 1 . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , additionally make sure that director equals name . make sure no repetition in the results . [question] What are the different reviewer names , movie titles , and stars for every rating where the reviewer had the same name as the director ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the name , title , rating stars of the results of step 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
use order items table in place of orders table . find number of different product id in place of number of rows . [question] Show order ids and the number of products in each order . [system description] find each value of order id in orders table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
consider the first name equals Marina or last name equals Kohler conditions in place of the last name equals Goodwin or first name equals Genevieve conditions . [question] What is the status code , mobile phone number and email address of customer with last name as Kohler or first name as Marina ? [system description] find the customer status code , cell mobile phone number , email address in customers table whose last name equals " Goodwin " or first name equals " Genevieve " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name [C] middle name [C] last name [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name ( Marina ) [C] last name ( Kohler ) [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
additionally find account name . [question] Show the id , the date of account opened , the account name , and other account detail for all accounts . [system description] find the account id , date account opened , date account opened , other account details in accounts table . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , do not use the customers table . [question] How many accounts does each customer have ? List the number and customer id . [system description] Step 1 : for each row in customers table , find the corresponding rows in accounts table . Step 2 : find each value of customers 's customer id of the results of step 1 along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , consider the name equals Sarah Martinez conditions in place of the name equals Brittany Harris conditions . make sure no repetition in the results . [question] What are the names of all directors whose movies have been reviewed by Sarah Martinez ? [system description] Step 1 : for each row in reviewer table , find the corresponding rows in rating table and in movie table . Step 2 : find the director of the results of step 1 whose name equals " Brittany Harris " . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name ( Sarah Martinez ) [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , do not use the invoices table . [question] How many transactions correspond to each invoice number ? [system description] Step 1 : for each row in invoices table , find the corresponding rows in financial transactions table . Step 2 : find each value of financial transactions 's invoice number of the results of step 1 along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 1 , use rating table in place of reviewer table . in step 2 , consider the rating stars equals 4 conditions in place of the rating stars equals 2 conditions . [question] find the ids of reviewers who did not give 4 star . [system description] Step 1 : find the reviewer 's reviewer id in reviewer table . Step 2 : find the rating 's reviewer id in rating table whose rating stars equals 2 . Step 3 : show the rows that are in the results of step 1 but not in the results of step 2 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the director not equals null conditions in place of the rating stars equals 5 conditions . in step 4 , find maximum rating stars in place of summation of rating stars . find rating stars in place of summation of rating stars . you should not find the largest of the results . show me all the results . [question] For each director , return the director 's name together with the title of the movie they directed that received the highest rating among all of their movies , and the value of that rating . Ignore movies whose director is NULL . [system description] Step 1 : for each row in movie table , find the corresponding rows in rating table . Step 2 : only keep the results of step 1 whose rating stars equals 5 . Step 3 : find the number of rows of each value of director the results of step 2 . Step 4 : find the director , title , summation of rating stars the results of step 2 with largest value in the results of step 3 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 1 , additionally use the information from the rating table besides the reviewer table . find for each value of rating 's reviewer id whose number of rows greater than or equals 3 . [question] What are the names of all reviewers that have rated 3 or more movies ? [system description] Step 1 : find the number of rows of each value of name in reviewer table . Step 2 : find the name in reviewer table whose corresponding value in step 1 is greater than or equals 1 . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally use the information from the reviewer table besides the rating table . find for each value of name . additionally find name . [question] What is the average rating star for each reviewer ? [system description] find the average rating stars and average rating stars in rating table . [schema] [T] movie [C] movie id [C] title [C] year [C] director [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
additionally use the information from the accounts table besides the customers table . additionally find accounts 's customer id . [question] What are the the full names and ids for all customers , and how many accounts does each have ? [system description] find each value of customer id in customers table along with the number of the corresponding rows to each value . [schema] [T] customers [C] customer id [C] customer first name [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
in step 2 , consider the first name equals Janessa and last name equals Sawayn conditions in place of the first name equals Kaitlin conditions . [question] What is the total time for all lessons taught by Janessa Sawayn ? [system description] Step 1 : for each row in staff table , find the corresponding rows in lessons table . Step 2 : find the summation of lesson time of the results of step 1 whose first name equals " Kaitlin " . [schema] [T] addresses [C] address id [C] line 1 number building [C] city [C] zip postcode [C] state province county [C] country [T] staff [C] staff id [C] staff address id [C] nickname [C] first name ( Janessa ) [C] middle name [C] last name ( Sawayn ) [C] date of birth [C] date joined staff [C] date left staff [T] vehicles [C] vehicle id [C] vehicle details [T] customers [C] customer id [C] customer address id [C] customer status code [C] date became customer [C] date of birth [C] first name [C] last name [C] amount outstanding [C] email address [C] phone number [C] cell mobile phone number [T] customer payments [C] customer id [C] datetime payment [C] payment method code [C] amount payment [T] lessons [C] lesson id [C] customer id [C] lesson status code [C] staff id [C] vehicle id [C] lesson date [C] lesson time [C] price
consider the year is greater than maximum year movie whose director equals Steven Spielberg conditions in place of the year greater than 1982 conditions . you should not find the largest of the results . show me all the results . [question] What are the names of all movies that were created after the most recent Steven Spielberg film ? [system description] find the title in movie table whose year greater than 1982 with largest value of year . [schema] [T] movie [C] movie id [C] title [C] year [C] director ( Steven Spielberg ) [T] reviewer [C] reviewer id [C] name [T] rating [C] reviewer id [C] movie id [C] rating stars [C] rating date
in step 2 , consider the customer first name equals Meaghan conditions in place of the customer first name equals Dee conditions . find other account details and account id in place of accounts 's customer id . [question] What are the ids , names , dates of opening , and other details for accounts corresponding to the customer with the first name " Meaghan " ? [system description] Step 1 : for each row in customers table , find the corresponding rows in accounts table . Step 2 : find the accounts 's customer id , account name , date account opened of the results of step 1 whose customer first name equals " Dee " . [schema] [T] customers [C] customer id [C] customer first name ( Meaghan ) [C] customer middle initial [C] customer last name [C] gender [C] email address [C] login name [C] login password [C] phone number [C] town city [C] state county province [C] country [T] orders [C] order id [C] customer id [C] date order placed [C] order details [T] invoices [C] invoice number [C] order id [C] invoice date [T] accounts [C] account id [C] customer id [C] date account opened [C] account name [C] other account details [T] product categories [C] production type code [C] product type description [C] vat rating [T] products [C] product id [C] parent product id [C] production type code [C] unit price [C] product name [C] product color [C] product size [T] financial transactions [C] transaction id [C] account id [C] invoice number [C] transaction type [C] transaction date [C] transaction amount [C] transaction comment [C] other transaction details [T] order items [C] order item id [C] order id [C] product id [C] product quantity [C] other order item details [T] invoice line items [C] order item id [C] invoice number [C] product id [C] product title [C] product quantity [C] product price [C] derived product cost [C] derived vat payable [C] derived total cost
